# 登記概要ビュー UI 設計

## 目的
- 第5フェーズで実装する「登記概要」タブの画面構成を明文化し、実装チーム・デザイナー間で共通理解を持つ。
- 土地／建物が複数存在する資産でも迷子にならない情報整理を行い、紙の登記簿からの転記負荷を軽減する。

## 全体レイアウト（デスクトップ）

```
┌────────────────────────────────────────────────────────┐
│ 固定ヘッダー：WHERE / 資産管理 ＞ [物件名]          アクション（PDF出力） │
└────────────────────────────────────────────────────────┘
┌──────────────────┬────────────────────────────────────────────┐
│ 左サマリー（固定）│ 右サイド：登記概要タブ                                 │
│ ・物件名／所在      │ ┌────────────────────────────────────┐ │
│ ・合計地積         │ │ 物件選択ヘッダー                                   │ │
│ ・評価レンジ       │ │  [地番トグル][地番トグル][＋]  [建物ドロップダウン]   │ │
│ ・接道要点         │ └────────────────────────────────────┘ │
│ ・最終更新         │ ┌────────────────────────────────────┐ │
│ ・ショートカット   │ │ 地積サマリーカード                                   │ │
│   - 地番ごと表示    │ │  合計地積 / 土地数 / 測量区分ピル                     │ │
│   - 登記簿PDF閲覧   │ └────────────────────────────────────┘ │
│                    │ ┌────────────────────────────────────┐ │
│                    │ │ 登記概要パネル                                   │ │
│                    │ │  ┌────────────┬────────────┬─────────┐ │
│                    │ │  │ 表題部         │ 権利部甲区     │ 権利部乙区   │ │
│                    │ │  │  所在／地目    │  所有者一覧    │  抵当等一覧  │ │
│                    │ │  │  地積／家屋    │  持分・登記日   │  権利・登記日│ │
│                    │ │  └────────────┴────────────┴─────────┘ │
│                    │ │  [折りたたみ矢印]                                     │ │
│                    │ └────────────────────────────────────┘ │
│                    │ ┌────────────────────────────────────┐ │
│                    │ │ 添付情報／メタデータ                                 │ │
│                    │ │  図面サムネイル、最終取得日、登記取得ステータス        │ │
│                    │ └────────────────────────────────────┘ │
└──────────────────┴────────────────────────────────────────────┘
```

### 左サマリー
- 既存マスターページ仕様と同様に固定。登記ビューでは「合計地積」「地番数」「建物数」を優先表示。
- ショートカット：`開示用PDF`、`登記簿原本リンク`（存在する場合）。

### 物件選択ヘッダー
- 地番トグル：最大5件横並び、6件目以降はスライド式 + チップで `＋` を押すとモーダル一覧。
- 選択中地番には面積と地目をツールチップ表示。
- 建物選択：対象地番に複数棟ある場合のみプルダウンを表示。不存在の場合は非表示。

### 登記概要パネル
- 表題部／権利部を横3分割。スクロール時にはヘッダー行をスティッキー化して列の意味を保持。
- 欄ごとにアイコンラベル（📄表題部／👥権利甲／🔏権利乙）を付与し、登記簿構成と対応させる。
- 折りたたみ機能：権利部乙区が存在しない地番は自動で畳んで「該当なし」を表示。

### 添付情報
- 図面サムネイルは3カラムカード。未登録の場合はアップロード誘導を表示。
- 最終取得日・データソース（登記情報提供サービスなど）を右上に表示。

## モバイルレイアウト

```
┌────────────────────────┐
│ ヘッダー（戻る ← / 物件名 / …） │
└────────────────────────┘
[合計地積カード]
[地番スライドピル横スクロール]
[建物セレクタ]
[アコーディオン：表題部]
[アコーディオン：権利部甲区]
[アコーディオン：権利部乙区]
[添付情報カルーセル]
```

- 左サマリーはヘッダー直下のコンパクトカードにまとめる。
- 表題部／権利部はアコーディオンで折りたたみ、必要時のみ展開。
- 合計地積カードには坪換算スイッチを配置。

## コンポーネント一覧

| コンポーネント | 役割 | 備考 |
| --- | --- | --- |
| `RegistrySelector` | 地番・建物の選択 UI | トグルリスト＋ドロップダウン。レスポンシブで縦並び |
| `RegistrySummaryCard` | 合計地積表示 | 坪換算・測量区分タグ |
| `RegistryLedgerPanel` | 表題部・権利部をタブular表示 | カラム幅固定。権利数が多い場合は内部スクロール |
| `AttachmentStrip` | 図面・資料サムネイル | 登録状態に応じて CTA 切替 |
| `MetaBadgeGroup` | 最終更新／データソース | ドキュメント右上固定 |

## 状態と挙動

- **初期ロード**: サーバーから地番配列を取得。先頭地番を選択し、建物があれば最初の建物を自動選択。
- **選択変更**: 地番切替時に地積サマリー・登記概要パネルを差し替え。フェードアニメーション 200ms。
- **エンプティ状態**:
  - 地番未登録 → 「登記情報が登録されていません」カードと CSV インポート導線。
  - 権利部乙区無し → パネル内に `該当なし` のグレーステートメント。
- **エラー状態**: API 取得失敗時は左サマリーにトースト表示＋`再取得`ボタン。

## アクセシビリティ
- 地番トグルはキーボード操作可能な `role="tablist"`、建物セレクタは `aria-expanded` で開閉を通知。
- 表題部・権利部の表は `aria-describedby` でカラム説明を付与し、スクリーンリーダーで原文の構造が理解できるよう補足テキストを配置。

## 未決事項 / TODO
1. 既存「法務」タブとの情報重複整理（廃止・統合対象を確認）。
2. 図面ファイルのバージョニング UI（第6フェーズで対応予定）。
3. API 仕様：地番の表示順／グルーピングルールをバックエンドとすり合わせ。

